<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI Lease Negotiation Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-slate-900 to-blue-900 min-h-screen text-white">

<div class="max-w-7xl mx-auto p-6">
    <h1 class="text-4xl font-bold mb-6">
        ðŸ¤– AI Lease Negotiation Assistant
    </h1>

    <div class="grid grid-cols-3 gap-6">

        <!-- LEFT INFO PANEL -->
        <div class="space-y-4">
            <div class="bg-white/10 backdrop-blur-lg p-4 rounded-xl">
                <h2 class="font-semibold text-lg">ðŸ“„ Contract Analysis</h2>
                <p class="text-sm opacity-80">
                    Lease terms, penalties, mileage, APR
                </p>
            </div>

            <div class="bg-white/10 backdrop-blur-lg p-4 rounded-xl">
                <h2 class="font-semibold text-lg">ðŸš— Vehicle Insights</h2>
                <p class="text-sm opacity-80">
                    Vehicle specs, recalls & safety
                </p>
            </div>

            <div class="bg-white/10 backdrop-blur-lg p-4 rounded-xl">
                <h2 class="font-semibold text-lg">ðŸ’° Market Comparison</h2>
                <p class="text-sm text-green-400 font-semibold">
                    Negotiation opportunities detected
                </p>
            </div>
        </div>

        <!-- CHAT PANEL -->
        <div class="col-span-2 bg-black/30 backdrop-blur-lg rounded-xl p-6 flex flex-col">
            <div id="chat" class="flex-1 overflow-y-auto mb-4 space-y-3">
                <div class="text-sm opacity-70">
                    Ask questions like:
                    <ul class="list-disc list-inside">
                        <li>Is this lease overpriced?</li>
                        <li>Can I negotiate the monthly payment?</li>
                        <li>Are there hidden penalties?</li>
                    </ul>
                </div>
            </div>

            <div class="flex gap-3">
                <input
                    id="question"
                    type="text"
                    placeholder="Ask your question..."
                    class="flex-1 p-3 rounded-lg text-black outline-none"
                />
                <button
                    onclick="send()"
                    class="bg-blue-600 hover:bg-blue-700 transition px-6 rounded-lg font-semibold"
                >
                    Send
                </button>
            </div>
        </div>

    </div>
</div>

<script>
async function send() {
    const input = document.getElementById("question");
    const question = input.value.trim();
    if (!question) return;

    const formData = new FormData();
    formData.append("user_question", question);

    const res = await fetch("/chat_process", {
        method: "POST",
        body: formData
    });

    const data = await res.json();
    const chat = document.getElementById("chat");
    chat.innerHTML = "";

    data.chat_history.forEach(msg => {
        const div = document.createElement("div");
        div.className = msg.role === "user"
            ? "text-right bg-blue-600/70 p-3 rounded-lg"
            : "text-left bg-white/10 p-3 rounded-lg";
        div.innerText = msg.text;
        chat.appendChild(div);
    });

    input.value = "";
}
</script>

</body>
</html>
